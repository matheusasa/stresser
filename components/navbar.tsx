"use client";

import { isAuthenticated, signOut } from "@/utils/auth";
import { Button } from "@/components/ui/button";
import React, { useEffect, useState } from "react";
import Link from "next/link";
import {
  Code,
  House,
  LaptopMinimal,
  Lightbulb,
  ShoppingCart,
} from "lucide-react";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

const Navbar: React.FC = () => {
  const [isOpen, setIsOpen] = useState<boolean>(false);
  const [authenticated, setAuthenticated] = useState<boolean>(false);

  const toggleMenu = () => {
    setIsOpen(!isOpen);
  };

  useEffect(() => {
    setAuthenticated(isAuthenticated());
  }, []);

  return (
    <nav className="h-[64px] bg-[#161616] flex items-center px-4">
      <div className="flex items-center justify-between w-full max-w-[1140px] mx-auto">
        {/* Logo à esquerda */}
        <div className="flex items-center px-4">
          <Link href="/">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="177"
              height="46"
              viewBox="0 0 177 46"
              fill="none"
            >
              <g clipPath="url(#clip0_78_356)">
                <path
                  d="M10.919 0H34.9533C40.9792 0 45.8722 4.90667 45.8722 10.9494V35.0519C45.8722 41.0946 40.9792 46.0012 34.9533 46.0012H10.919C4.89304 46 0 41.0933 0 35.0506V10.9494C0 4.90667 4.89304 0 10.919 0Z"
                  fill="url(#paint0_linear_78_356)"
                />
                <path
                  d="M23.81 28.9309C23.8472 28.9148 23.8719 28.8788 23.8732 28.8391C23.9363 27.6583 23.914 26.4813 23.8051 25.3056C23.7816 25.0411 23.7159 24.8611 23.6107 24.7642C23.0647 24.2713 22.7663 24.0019 22.7143 23.9547C22.4134 23.6866 22.1819 23.4234 22.0172 23.1663C21.73 22.7157 21.4861 22.26 21.288 21.7969C21.106 21.371 20.9723 20.9092 20.8868 20.4101C20.7927 19.8663 20.7556 19.2852 20.7742 18.6694C20.7965 17.9692 20.872 17.326 21.0032 16.7388C21.3301 15.6201 21.9058 14.6529 22.7292 13.8372C23.0635 13.507 23.2863 13.2673 23.399 13.1184C23.7444 12.6602 23.841 11.9476 23.8323 11.3876C23.8323 11.3752 23.8224 11.3653 23.81 11.3653C22.255 11.338 20.6652 11.3268 19.0408 11.3355C18.9405 11.3355 18.7957 11.3417 18.6025 11.3541C18.5604 11.3566 18.5282 11.3926 18.5282 11.4336L18.496 17.2056L18.4936 20.4411C18.4936 20.4734 18.4676 20.4995 18.4354 20.4995C15.7821 20.5119 13.4259 20.5094 11.367 20.4933C11.2345 20.4933 11.1379 20.4908 11.0785 20.4883C11.0302 20.4858 10.9918 20.4461 10.9918 20.3977V11.4683C10.9869 11.4187 10.9472 11.3752 10.8965 11.3727H5.27914C5.26057 11.3727 5.24571 11.3876 5.24571 11.4062L5.23209 28.8962L5.20361 34.4547C5.20361 34.5242 5.23828 34.5602 5.30762 34.5614C7.10289 34.5962 8.98854 34.5999 10.967 34.5739C10.9906 34.5739 11.0017 34.5627 11.0017 34.5391L11.0426 26.0977L18.4465 26.0878C18.4899 26.0878 18.5109 26.1089 18.5109 26.1523C18.5035 28.1314 18.5035 30.391 18.5084 32.9325C18.5097 33.5173 18.5196 34.0338 18.5369 34.4795C18.5394 34.5279 18.5753 34.5676 18.6236 34.5739L19.359 34.6645C19.3999 34.6695 19.4382 34.6459 19.4506 34.6074C19.5955 34.179 19.7391 33.7532 19.884 33.3298C20.1601 32.5253 20.5377 31.8002 21.0193 31.1509C21.7424 30.1762 22.6722 29.435 23.8063 28.9297L23.81 28.9309Z"
                  fill="white"
                />
                <path
                  d="M40.6309 11.3665C40.5307 11.3814 40.4192 11.3876 40.2966 11.3876C35.0173 11.3752 31.4392 11.3752 29.5609 11.3864C28.6819 11.3913 28.1297 11.4062 27.9019 11.4298C27.3645 11.4857 26.7715 11.6508 26.1252 11.9277C25.3897 12.2418 24.7731 12.5708 24.2767 12.9147C24.0117 13.101 23.7839 13.2897 23.5957 13.4834C23.228 13.8596 22.8677 14.3512 22.573 14.7858C21.9614 15.6872 21.5825 16.6754 21.4339 17.7482C21.4042 17.9704 21.3832 18.2498 21.3733 18.5862C21.3547 19.2442 21.3696 19.7322 21.5082 20.3703C21.6939 21.2034 21.9725 21.9198 22.3439 22.5183C22.6485 23.0087 23.098 23.5475 23.696 24.1335C23.9275 24.362 24.185 24.5519 24.4698 24.7059C24.9923 24.9877 25.4504 25.2087 25.8441 25.3701C26.4656 25.6234 27.1169 25.7699 27.7979 25.8096C27.8957 25.8159 28.3748 25.8121 29.2365 25.7985C30.2568 25.7836 31.1928 25.7736 32.0434 25.7687C32.577 25.7662 32.9905 25.9239 33.2802 26.243C33.6343 26.6316 33.8609 27.0525 33.83 27.5603C33.7879 28.2456 33.4697 28.7969 32.8754 29.2128C32.6859 29.3456 32.447 29.3916 32.2204 29.3928C30.2048 29.4027 28.1891 29.3978 26.1734 29.3767C25.391 29.368 24.8957 29.3692 24.6865 29.3767C24.346 29.3903 24.0637 29.4263 23.8371 29.4847C23.5944 29.548 23.3518 29.6722 23.1091 29.8584C22.6114 30.242 22.261 30.5214 22.0604 30.6964C21.3881 31.3818 20.8867 32.1851 20.5586 33.1076C20.5004 33.2702 20.3716 33.6464 20.1723 34.2362C20.1314 34.3553 20.1104 34.4696 20.1079 34.5801C20.1079 34.6099 20.1215 34.6248 20.1512 34.6235C20.8656 34.5974 21.6754 34.585 22.5804 34.5875C23.9783 34.5912 25.3761 34.5925 26.7715 34.5912C28.2646 34.6012 29.7566 34.6074 31.2473 34.6111C31.7054 34.6123 32.2031 34.6074 32.7404 34.5937C34.0404 34.5639 35.2761 34.0735 36.3198 33.3124C37.3301 32.5774 38.1213 31.6537 38.6958 30.54C38.9211 30.103 39.0944 29.656 39.2145 29.1991C39.5377 27.9749 39.5364 26.6986 39.2108 25.3739C39.0647 24.7779 38.8183 24.1944 38.4717 23.6208C37.7189 22.3755 36.7185 21.4679 35.4705 20.898C34.9529 20.6621 34.4317 20.5181 33.9043 20.4684C33.3384 20.4138 32.7169 20.3902 32.0384 20.3977C31.6967 20.4014 30.8758 20.3989 29.5746 20.3915C29.0954 20.389 28.719 20.3542 28.4454 20.2872C28.1297 20.2102 27.8783 20.0587 27.6914 19.8315C27.1664 19.1958 27.0872 18.4894 27.4537 17.7146C27.6839 17.2279 28.0641 16.9362 28.5964 16.8418C28.9134 16.7859 29.2576 16.7599 29.629 16.7636C31.2708 16.7797 33.1057 16.7835 35.1337 16.7748C35.9075 16.7723 37.0181 16.8133 37.7734 16.7313C37.891 16.7189 37.9739 16.6668 38.021 16.5736C38.3293 15.9802 38.6215 15.4326 38.8963 14.9311C39.1663 14.4381 39.3854 14.0098 39.555 13.6498C39.945 12.8179 40.3127 12.073 40.6582 11.4149C40.6619 11.4087 40.6631 11.4025 40.6619 11.3963C40.6594 11.3789 40.6433 11.3678 40.6272 11.3702L40.6309 11.3665Z"
                  fill="white"
                />
                <path
                  d="M64.2793 22.0142V16.1006H66.2454V29.8969H64.2793V23.9846H58.3833V29.8969H56.4185V16.1006H58.3833V22.0142H64.2793Z"
                  fill="white"
                />
                <path
                  d="M70.1753 29.8981H68.2104V16.1019H70.1753V29.8981Z"
                  fill="white"
                />
                <path
                  d="M74.106 23.9858V29.8982H72.1411V16.1019H79.0201C79.8323 16.1019 80.5269 16.3912 81.1038 16.9698C81.6808 17.5483 81.9693 18.2448 81.9693 19.0593V21.0297C81.9693 21.8441 81.6808 22.5407 81.1038 23.1192C80.5269 23.6978 79.8323 23.9871 79.0201 23.9871H74.106V23.9858ZM74.106 18.0723V22.0142H79.0201C79.295 22.0142 79.5277 21.9186 79.7184 21.7287C79.9078 21.5387 80.0032 21.3053 80.0032 21.0284V19.0581C80.0032 18.7824 79.9078 18.549 79.7184 18.3578C79.5277 18.1679 79.2962 18.0723 79.0201 18.0723H74.106Z"
                  fill="white"
                />
                <path
                  d="M93.761 16.1019V18.0735H85.899V22.0154H91.7949V23.987H85.899V27.929H93.761V29.9006H83.9341V16.1044H93.761V16.1019Z"
                  fill="white"
                />
                <path
                  d="M103.411 23.8679L105.278 25.76C105.461 25.9698 105.553 26.2008 105.553 26.4503V29.8994H103.587V26.8439L100.776 23.9858H97.691V29.8981H95.7261V16.1019H102.605C103.417 16.1019 104.112 16.3912 104.689 16.9697C105.266 17.5483 105.554 18.2448 105.554 19.0593V21.0296C105.554 21.7001 105.355 22.2948 104.955 22.8138C104.555 23.3327 104.041 23.6841 103.412 23.8679H103.411ZM97.6922 22.0142H102.606C102.881 22.0142 103.114 21.9186 103.305 21.7286C103.494 21.5387 103.589 21.3053 103.589 21.0284V19.058C103.589 18.7824 103.494 18.549 103.305 18.3578C103.114 18.1678 102.882 18.0722 102.606 18.0722H97.6922V22.0142Z"
                  fill="white"
                />
                <path
                  d="M117.053 29.8981H113.122C112.31 29.8981 111.615 29.6089 111.038 29.0315C110.461 28.453 110.174 27.7577 110.174 26.942V26.3311H112.139V26.942C112.139 27.2176 112.234 27.451 112.423 27.6422C112.613 27.8334 112.846 27.9278 113.122 27.9278H117.053C117.328 27.9278 117.56 27.8322 117.751 27.6422C117.941 27.4523 118.036 27.2188 118.036 26.942V25.976C118.022 25.6867 117.853 25.4508 117.525 25.2671L111.726 22.4686C111.215 22.1793 110.829 21.8118 110.566 21.3649C110.304 20.9179 110.174 20.4784 110.174 20.0438V19.058C110.174 18.2436 110.462 17.547 111.038 16.9685C111.615 16.3899 112.308 16.1006 113.122 16.1006H117.053C117.865 16.1006 118.56 16.3899 119.137 16.9685C119.714 17.547 120.002 18.2436 120.002 19.058V19.6689H118.036V19.058C118.036 18.7824 117.941 18.549 117.751 18.3578C117.56 18.1678 117.329 18.0722 117.053 18.0722H113.122C112.847 18.0722 112.614 18.1678 112.423 18.3578C112.233 18.549 112.139 18.7812 112.139 19.058V20.024C112.151 20.3132 112.322 20.5491 112.65 20.7329L118.448 23.5314C118.96 23.8207 119.346 24.1882 119.608 24.6351C119.871 25.0821 120.002 25.5216 120.002 25.9562V26.942C120.002 27.7564 119.714 28.453 119.137 29.0315C118.56 29.6101 117.865 29.8981 117.053 29.8981Z"
                  fill="#42B3F8"
                />
                <path
                  d="M120.984 16.1019H130.811V18.0735H126.88V29.8994H124.915V18.0735H120.984V16.1019Z"
                  fill="#42B3F8"
                />
                <path
                  d="M140.462 23.8679L142.329 25.76C142.512 25.9698 142.604 26.2008 142.604 26.4503V29.8994H140.638V26.8439L137.827 23.9858H134.742V29.8981H132.777V16.1019H139.656C140.468 16.1019 141.163 16.3912 141.74 16.9697C142.317 17.5483 142.605 18.2448 142.605 19.0593V21.0296C142.605 21.7001 142.406 22.2948 142.006 22.8138C141.606 23.3327 141.092 23.6841 140.463 23.8679H140.462ZM134.742 22.0142H139.656C139.931 22.0142 140.163 21.9186 140.354 21.7286C140.544 21.5387 140.639 21.3053 140.639 21.0284V19.058C140.639 18.7824 140.544 18.549 140.354 18.3578C140.163 18.1678 139.932 18.0722 139.656 18.0722H134.742V22.0142Z"
                  fill="#42B3F8"
                />
                <path
                  d="M154.397 16.1019V18.0735H146.535V22.0154H152.431V23.987H146.535V27.929H154.397V29.9006H144.57V16.1044H154.397V16.1019Z"
                  fill="#42B3F8"
                />
                <path
                  d="M162.749 29.8981H158.818C158.006 29.8981 157.311 29.6089 156.734 29.0315C156.157 28.453 155.87 27.7577 155.87 26.942V26.3311H157.835V26.942C157.835 27.2176 157.93 27.451 158.12 27.6422C158.309 27.8334 158.542 27.9278 158.818 27.9278H162.749C163.024 27.9278 163.257 27.8322 163.447 27.6422C163.637 27.4523 163.732 27.2188 163.732 26.942V25.976C163.719 25.6867 163.549 25.4508 163.221 25.2671L157.423 22.4686C156.911 22.1793 156.525 21.8118 156.263 21.3649C156 20.9179 155.87 20.4784 155.87 20.0438V19.058C155.87 18.2436 156.159 17.547 156.734 16.9685C157.311 16.3899 158.005 16.1006 158.818 16.1006H162.749C163.561 16.1006 164.256 16.3899 164.833 16.9685C165.41 17.547 165.698 18.2436 165.698 19.058V19.6689H163.732V19.058C163.732 18.7824 163.637 18.549 163.447 18.3578C163.257 18.1678 163.025 18.0722 162.749 18.0722H158.818C158.543 18.0722 158.31 18.1678 158.12 18.3578C157.929 18.549 157.835 18.7812 157.835 19.058V20.024C157.847 20.3132 158.018 20.5491 158.346 20.7329L164.144 23.5314C164.656 23.8207 165.042 24.1882 165.305 24.6351C165.567 25.0821 165.698 25.5216 165.698 25.9562V26.942C165.698 27.7564 165.41 28.453 164.833 29.0315C164.256 29.6101 163.561 29.8981 162.749 29.8981Z"
                  fill="#42B3F8"
                />
                <path
                  d="M174.051 29.8981H170.12C169.308 29.8981 168.613 29.6089 168.036 29.0315C167.459 28.453 167.172 27.7577 167.172 26.942V26.3311H169.137V26.942C169.137 27.2176 169.232 27.451 169.422 27.6422C169.611 27.8334 169.844 27.9278 170.12 27.9278H174.051C174.326 27.9278 174.558 27.8322 174.749 27.6422C174.939 27.4523 175.034 27.2188 175.034 26.942V25.976C175.02 25.6867 174.851 25.4508 174.523 25.2671L168.724 22.4686C168.213 22.1793 167.827 21.8118 167.564 21.3649C167.302 20.9179 167.172 20.4784 167.172 20.0438V19.058C167.172 18.2436 167.46 17.547 168.036 16.9685C168.613 16.3899 169.306 16.1006 170.12 16.1006H174.051C174.863 16.1006 175.558 16.3899 176.135 16.9685C176.712 17.547 177 18.2436 177 19.058V19.6689H175.034V19.058C175.034 18.7824 174.939 18.549 174.749 18.3578C174.558 18.1678 174.327 18.0722 174.051 18.0722H170.12C169.845 18.0722 169.612 18.1678 169.422 18.3578C169.231 18.549 169.137 18.7812 169.137 19.058V20.024C169.149 20.3132 169.32 20.5491 169.648 20.7329L175.446 23.5314C175.958 23.8207 176.344 24.1882 176.606 24.6351C176.869 25.0821 177 25.5216 177 25.9562V26.942C177 27.7564 176.712 28.453 176.135 29.0315C175.558 29.6101 174.863 29.8981 174.051 29.8981Z"
                  fill="#42B3F8"
                />
              </g>
              <defs>
                <linearGradient
                  id="paint0_linear_78_356"
                  x1="8.8513"
                  y1="8.87595"
                  x2="38.8685"
                  y2="38.8098"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stopColor="#42B3F8" />
                  <stop offset="1" stopColor="#1730E2" />
                </linearGradient>
                <clipPath id="clip0_78_356">
                  <rect width="177" height="46" fill="white" />
                </clipPath>
              </defs>
            </svg>{" "}
          </Link>
        </div>

        {/* Links no centro */}
        {authenticated && (
          <div className="flex items-center space-x-4">
            <div className="lg:hidden">
              <button
                onClick={toggleMenu}
                className="text-white focus:outline-none"
              >
                <svg
                  className="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth="2"
                    d="M4 6h16M4 12h16m-7 6h7"
                  />
                </svg>
              </button>
            </div>

            <div
              className={`${
                isOpen ? "block" : "hidden"
              } lg:flex lg:space-x-6 bg-[#181818] lg:bg-transparent p-4 lg:p-0 z-50`}
            >
              <Link
                href="/dashboard"
                className="flex items-center text-white py-4 lg:inline"
              >
                <div className="flex">
                  <House />
                  <div className="pl-2">Dashboard</div>
                </div>
              </Link>

              <Link
                href="/painel"
                className="flex items-center text-white py-4 lg:inline"
              >
                <div className="flex">
                  <LaptopMinimal />
                  <div className="pl-2">Painel</div>
                </div>
              </Link>

              <Link
                href="/"
                className="flex items-center text-white py-4 lg:inline"
              >
                <div className="flex">
                  <Code />
                  <div className="pl-2">API</div>
                </div>
              </Link>

              <Link
                href="/store"
                className="flex items-center text-white py-4 lg:inline"
              >
                <div className="flex">
                  <ShoppingCart />
                  <div className="pl-2">Store</div>
                </div>
              </Link>

              <Link
                href="/"
                className="flex items-center text-white py-4 lg:inline"
              >
                <div className="flex">
                  <Lightbulb />
                  <div className="pl-2">Methods</div>
                </div>
              </Link>
            </div>
          </div>
        )}

        {/* Botão do avatar à direita */}
        <div className="flex items-center">
          {authenticated ? (
            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Button variant="ghost" className="rounded-full">
                  <Avatar className="h-8 w-8">
                    <AvatarImage src="/placeholder-user.jpg" alt="@shadcn" />
                    <AvatarFallback>JD</AvatarFallback>
                  </Avatar>
                </Button>
              </DropdownMenuTrigger>
              <DropdownMenuContent align="end" className="w-[320px]">
                <div className="flex items-center gap-4 border-b p-4">
                  <Avatar className="h-12 w-12">
                    <AvatarImage src="/placeholder-user.jpg" alt="@shadcn" />
                    <AvatarFallback>JD</AvatarFallback>
                  </Avatar>
                  <div className="grid gap-1">
                    <h4 className="text-lg font-semibold">John Doe</h4>
                    <p className="text-sm text-muted-foreground">
                      john@example.com
                    </p>
                  </div>
                </div>
                <DropdownMenuSeparator />
                <DropdownMenuItem>
                  <Button variant={"ghost"} onClick={signOut}>
                    Sign Out
                  </Button>
                </DropdownMenuItem>
              </DropdownMenuContent>
            </DropdownMenu>
          ) : (
            <Link href="/login">
              <Button className="rounded-xl bg-[#161616] border-[#343434] border-2 hover:bg-gradient-start">
                Login
              </Button>
            </Link>
          )}
        </div>
      </div>
    </nav>
  );
};

export default Navbar;
